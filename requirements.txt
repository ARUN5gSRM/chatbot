Django
numpy
scipy

torch
transformers
sentence-transformers
tokenizers
sentencepiece
accelerate
huggingface-hub


faiss-cpu

pandas
openpyxl

python-magic
PyPDF2
pymupdf

tqdm
requests
Pillow
beautifulsoup4
urllib3
nltk

psycopg2-binary

import os
import numpy as np

# --------------------------------------------------
# FORCE OFFLINE MODE (IMPORTANT)
# --------------------------------------------------
os.environ["HF_HUB_OFFLINE"] = "1"
os.environ["TRANSFORMERS_OFFLINE"] = "1"
os.environ["HF_DATASETS_OFFLINE"] = "1"
os.environ["HF_HUB_DISABLE_TELEMETRY"] = "1"

from sentence_transformers import SentenceTransformer

# --------------------------------------------------
# PATH TO YOUR LOCAL MODEL FOLDER
# (must contain modules.json, model.safetensors, 1_Pooling/)
# --------------------------------------------------
MODEL_PATH = r"C:\Users\venka\PycharmProjects\upchat\Chatbot_project\local_models\nomic-embed-text-v1.5"

# --------------------------------------------------
# LOAD MODEL
# --------------------------------------------------
print("Loading model...")
model = SentenceTransformer(
    MODEL_PATH,
    device="cpu",
    trust_remote_code=True
)
print("Model loaded successfully ✅")

# --------------------------------------------------
# TEST EMBEDDINGS
# --------------------------------------------------
texts = [
    "Hello world",
    "This is a test sentence for embeddings",
    "Nomic embeddings offline check"
]

embeddings = model.encode(
    texts,
    normalize_embeddings=True,
    show_progress_bar=False
)

# --------------------------------------------------
# VALIDATE OUTPUT
# --------------------------------------------------
print("Embedding shape:", embeddings.shape)
print("First embedding (first 5 values):", embeddings[0][:5])

# Sanity checks
assert embeddings.shape[0] == len(texts), "Batch size mismatch"
assert embeddings.shape[1] == 768, "Embedding dimension is not 768"
assert not np.isnan(embeddings).any(), "NaNs found in embeddings"

print("✅ OFFLINE EMBEDDING TEST PASSED")
